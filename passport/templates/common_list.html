{% extends 'base/default.html' %}
{% load bootstrap5 %}
{% load render_table from django_tables2 %}
{% load export_url from django_tables2 %}
{% load widget_tweaks %}

{% block title %}{{ title }} list{% endblock title %}

{% block content %}
<div class="text-center">
  <h1>{{ title }} list</h1>
</div>

{% if filter %}
<form class="" action="" method="get" >
  <div class="input-group">
    <span class="input-group-text" id="counter-label">Items: {{ page_obj.paginator.count }}</span>
    {% for field in filter.form %}
      {% render_field field class="form-control" style="min-width: 100px;" title=field.label placeholder=field.label %}
    {% endfor %}
    {% bootstrap_button content='Filter' %}
    {% if filter.is_bound %}
      <a href="{% url request.resolver_match.view_name %}" class="btn btn-outline-primary">Clear filters</a>
    {% endif %}
    <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">Export</button>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="{% export_url 'csv' %}">CSV</a></li>
      <li><a class="dropdown-item" href="{% export_url 'ods' %}">ODS</a></li>
      <li><a class="dropdown-item" href="{% export_url 'xlsx' %}">XLSX</a></li>
    </ul>
  </div>
</form>
{% endif %}
<hr>

{% render_table table %}

{% if form %}
<div class="row justify-content-center">
  <form action="" method="post" class="col-auto">
    {{ form.media }}
    {% csrf_token %}

    <div class="input-group">
      <span class="input-group-text" id="create-label">New {{ title.lower }}:</span>
      {% for field in form %}
        {% if form.is_bound %}
          {% if field.errors %}
            {% render_field field class="form-control is-invalid" style="min-width: 100px;" placeholder=field.label %}
          {% else %}
            {% render_field field class="form-control is-valid" style="min-width: 100px;" placeholder=field.label %}
          {% endif %}
        {% else %}
          {% render_field field class="form-control" style="min-width: 100px;" placeholder=field.label %}
        {% endif %}
      {% endfor %}

      {% bootstrap_button button_type="submit" content="Create" %}
    </div>
    {% if form.errors %}
      {% for field in form %}
      <div class="text-danger">{{ field.errors }}</div>
      {% endfor %}
    {% endif %}
  </form>
</div>
{% endif %}
{% endblock content %}